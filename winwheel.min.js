!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Winwheel=e()}(this,function(){"use strict";function t(t){this.options=t||{},this.canvasId=this.options.canvasId||"canvas",this.centerX=this.options.centerX||null,this.centerY=this.options.centerY||null,this.outerRadius=this.options.outerRadius||null,this.innerRadius=this.options.innerRadius||0,this.numSegments=this.options.numSegments||1,this.segments=[],this.pointerAngle=this.options.pointerAngle||0,this.animation={},this.rotationAngle=0,this.drawMode=this.options.drawMode||"draw",this.lineWidth=this.options.lineWidth||1,this.strokeStyle=this.options.strokeStyle||"black",this.fillStyle=this.options.fillStyle||"white",this.textFontFamily=this.options.textFontFamily||"Arial",this.textFontSize=this.options.textFontSize||20,this.textFontWeight=this.options.textFontWeight||"bold",this.textOrientation=this.options.textOrientation||"horizontal",this.textAlignment=this.options.textAlignment||"center",this.textDirection=this.options.textDirection||"normal",this.textMargin=this.options.textMargin||0,this.textFillStyle=this.options.textFillStyle||"black",this.textStrokeStyle=this.options.textStrokeStyle||null,this.textLineWidth=this.options.textLineWidth||1,this.drawText=this.options.drawText||!0,this.responsive=this.options.responsive||!1,this.scaleFactor=this.options.scaleFactor||1,this.rotationAngle=this.options.rotationAngle||0,this.segments=[],this.ctx=null,this.canvas=null;var e=this.options.segments;if(e)for(var i=1;i<=this.numSegments;i++)this.segments[i]=e[i-1];if(this.options.animation){var n=this.options.animation;for(var o in n)this.animation[o]=n[o]}this.canvas=document.getElementById(this.canvasId),this.ctx=this.canvas.getContext("2d"),this.drawWheel()}return t.prototype.drawWheel=function(){var t=this.ctx,e=this.canvas.width,i=this.canvas.height;t.clearRect(0,0,e,i);var n=this.centerX||e/2,o=this.centerY||i/2,a=this.outerRadius||Math.min(e,i)/2;this.ctx.save(),this.ctx.translate(n,o),this.ctx.rotate(this.rotationAngle*Math.PI/180);for(var r=0;r<this.numSegments;r++){var s=2*Math.PI*(r/this.numSegments),h=2*Math.PI*((r+1)/this.numSegments);t.beginPath(),t.moveTo(0,0),t.arc(0,0,a,s,h,!1),t.closePath(),t.fillStyle=this.segments[r+1].fillStyle||this.fillStyle,t.fill(),this.lineWidth>0&&(t.strokeStyle=this.strokeStyle,t.lineWidth=this.lineWidth,t.stroke()),this.drawText&&this.segments[r+1].text&&this.drawSegmentText(r+1,s,h,a)}t.restore()},t.prototype.drawSegmentText=function(t,e,i,n){var o=this.ctx,a=(e+i)/2,r=this.textFontWeight+" "+this.textFontSize+"px "+this.textFontFamily;o.save(),o.rotate(a),o.translate(this.textMargin+n/2,0),o.rotate(this.textOrientation==="vertical"?-1*Math.PI/2:0),o.font=r,o.fillStyle=this.textFillStyle,this.textStrokeStyle&&(o.strokeStyle=this.textStrokeStyle,o.lineWidth=this.textLineWidth),"center"===this.textAlignment?o.textAlign="center":"left"===this.textAlignment?o.textAlign="left":o.textAlign="right","outer"===this.textDirection&&(o.scale(-1,1)),this.textStrokeStyle&&o.strokeText(this.segments[t].text,0,0),o.fillText(this.segments[t].text,0,0),o.restore()},t.prototype.startAnimation=function(){var t=this,e=(this.animation.spins||5)*360+(360*Math.random()),i=Date.now(),n=this.animation.duration||5e3,o=this.rotationAngle,a=function r(){var s=Date.now()-i,h=Math.min(s/n,1),c=o+(e-o)*h;t.rotationAngle=c,t.drawWheel(),h<1?requestAnimationFrame(r):t.animation.callbackFinished&&t.animation.callbackFinished(t.getIndicatedSegment())};requestAnimationFrame(a)},t.prototype.getIndicatedSegment=function(){var t=(360-this.rotationAngle+this.pointerAngle)%360,e=360/this.numSegments,i=Math.floor(t/e);return this.segments[i+1]},t});
